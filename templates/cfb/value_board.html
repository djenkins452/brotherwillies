{% extends "base.html" %}
{% block title %}Value Board - Brother Willies{% endblock %}

{% block content %}
<h1 class="page-title">CFB Value Board</h1>
<div class="mb-2"><a href="/cbb/value/" class="text-sm text-muted">Switch to CBB Value Board &rarr;</a></div>

{% if is_offseason %}
<div class="offseason-banner">
    <strong>Offseason</strong> &mdash; CFB season runs August through January. The games below are sample data for demonstration purposes only.
</div>
{% endif %}

{% if show_bye_message %}
<div class="card" style="border-color: var(--yellow);">
    <span class="badge badge-fav">Your Team</span>
    <span class="text-sm text-muted"> No games scheduled this week (bye week).</span>
</div>
{% endif %}

<div class="filter-bar">
    <a href="?sort=house_edge" class="filter-chip {% if sort_by == 'house_edge' %}active{% endif %}">House Edge</a>
    {% if user.is_authenticated %}
    <a href="?sort=user_edge" class="filter-chip {% if sort_by == 'user_edge' %}active{% endif %}">User Edge</a>
    <a href="?sort=delta" class="filter-chip {% if sort_by == 'delta' %}active{% endif %}">Delta</a>
    {% endif %}
</div>

{% for g in games_data %}
<a href="/cfb/game/{{ g.game.id }}/" class="game-card">
    {% if g.is_favorite %}
    <span class="badge badge-fav">Your Team</span>
    {% endif %}
    <div class="teams">
        <span class="team-name">{{ g.game.away_team.name }}</span>
        <span class="vs">@</span>
        <span class="team-name">{{ g.game.home_team.name }}</span>
    </div>
    <div class="game-meta">
        <span>{{ g.game.kickoff|date:"D M d, g:i A" }}</span>
        <span class="badge badge-{{ g.confidence_class }}">{{ g.confidence }}</span>
    </div>
    <div class="edge-row">
        <span>Mkt: {{ g.market_prob|floatformat:0 }}%</span>
        <span>House: <span class="{% if g.house_edge > 0 %}edge-positive{% elif g.house_edge < 0 %}edge-negative{% else %}edge-neutral{% endif %}">{{ g.house_edge|floatformat:1 }}%</span></span>
        {% if g.user_edge is not None %}
        <span>You: <span class="{% if g.user_edge > 0 %}edge-positive{% elif g.user_edge < 0 %}edge-negative{% else %}edge-neutral{% endif %}">{{ g.user_edge|floatformat:1 }}%</span></span>
        {% endif %}
    </div>
    {% if g.line_movement %}
    <div class="text-sm mt-1 {% if g.line_movement == 'up' %}line-up{% else %}line-down{% endif %}">
        Line moved
    </div>
    {% endif %}
</a>
{% empty %}
<div class="empty-state">
    <p>No games match your current filters.</p>
</div>
{% endfor %}

{% if is_gated %}
<div class="login-gate">
    <p>Showing {{ games_data|length }} of {{ total_count }} games. Log in to unlock the full Value Board.</p>
    <a href="/accounts/login/" class="btn btn-primary btn-sm">Log In</a>
    <a href="/accounts/register/" class="btn btn-secondary btn-sm">Register</a>
</div>
{% endif %}
{% endblock %}
